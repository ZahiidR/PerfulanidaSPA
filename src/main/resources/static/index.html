<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Perfulandia SPA - Perfumer√≠a Online</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet" />
  <style>
    /* Estilos b√°sicos para el prototipo */
    body {
      font-family: 'Roboto', sans-serif;
      padding-top: 56px;
    }
    
    .navbar {
      background-color: white;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .carousel-item {
      height: 500px;
      background-size: cover;
      background-position: center;
    }
    
    .carousel-caption {
      background-color: rgba(0,0,0,0.6);
      padding: 20px;
      border-radius: 5px;
    }
    
    .category-card {
      height: 300px;
      overflow: hidden;
      border-radius: 8px;
      position: relative;
    }
    
    .category-image {
      height: 100%;
      background-size: cover;
      background-position: center;
      transition: transform 0.3s;
    }
    
    .category-card:hover .category-image {
      transform: scale(1.05);
    }
    
    .category-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
      padding: 20px;
      color: white;
    }
    
    .newsletter {
      background-color: #6c757d;
    }
    
    .section-title {
      position: relative;
      padding-bottom: 15px;
    }
    
    .section-title:after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 3px;
      background-color: #0d6efd;
    }
    
    .card {
      transition: transform 0.3s, box-shadow 0.3s;
      border: none;
      box-shadow: 0 2px 15px rgba(0,0,0,0.1);
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
    }
    
    .cart-items {
      max-height: 300px;
      overflow-y: auto;
    }
    
    .empty-cart-message {
      color: #6c757d;
    }
    
    .admin-link {
      display: none;
    }
    
    .logged-in .admin-link {
      display: inline-block;
    }
    
    .logged-in .login-btn {
      display: none;
    }
    
    .user-greeting {
      display: none;
      margin-right: 10px;
    }
    
    .logged-in .user-greeting {
      display: inline-block;
    }
  </style>
</head>

<body>
  <!-- Barra de navegaci√≥n -->
  <nav class="navbar navbar-expand-lg navbar-light fixed-top">
    <div class="container">
      <a class="navbar-brand fw-bold" href="index.html">
        <i class="fas fa-spray-can-sparkles me-2"></i>Perfulandia SPA
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto">
          <li class="nav-item"><a class="nav-link active" href="index.html">Inicio</a></li>
          <li class="nav-item"><a class="nav-link" href="#men">Hombres</a></li>
          <li class="nav-item"><a class="nav-link" href="#women">Mujeres</a></li>
          <li class="nav-item"><a class="nav-link" href="#contact">Contacto</a></li>
        </ul>

        <div class="d-flex align-items-center">
          <div class="dropdown me-3">
            <button class="btn btn-outline-primary position-relative" type="button" id="cartDropdown" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="fas fa-shopping-cart"></i>
              <span id="contadorCarrito" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
            </button>
            <div class="dropdown-menu dropdown-menu-end p-3 cart-dropdown" aria-labelledby="cartDropdown">
              <div id="cartItems" class="cart-items">
                <p class="text-center empty-cart-message">Tu carrito est√° vac√≠o</p>
              </div>
              <div class="d-flex justify-content-between mt-3">
                <span>Total:</span>
                <span class="fw-bold cart-total">$0.00</span>
              </div>
              <div class="d-grid gap-2 mt-3">
                <button class="btn btn-primary btn-sm" onclick="window.location.href='cart.html'">Ver carrito</button>
                <button class="btn btn-success btn-sm" onclick="cart.checkout()">Pagar</button>
              </div>
            </div>
          </div>
          <div id="userSection">
            <span class="user-greeting me-2">Hola, <span id="usernameDisplay"></span></span>
            <a href="login.html" class="btn btn-outline-primary login-btn">Iniciar sesi√≥n</a>
            <a href="admin.html" class="btn btn-sm btn-secondary ms-2 admin-link">Admin</a>
            <button class="btn btn-outline-danger ms-2 logout-btn" style="display: none;" onclick="auth.logout()">Cerrar sesi√≥n</button>
          </div>
        </div>
      </div>
    </div>
  </nav>

  <!-- Hero Carousel -->
  <div id="perfumeCarousel" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-inner">
      <div class="carousel-item active" style="background-image: url('https://liblibai-online.liblib.cloud/img/eda547ba6388436cba74bb716ce0a10a/d3d8298e90129c86a9fbe74ca6c1846f831e9d121748acf0457157ac8efabc69.png?x-oss-process=image/resize,w_764,m_lfit/format,webp')">
        <div class="carousel-caption">
          <h1 class="display-4 fw-bold">Descubre Tu Fragancia Perfecta en PerfulandiaSPA! üòâ</h1>
          <p class="lead">Exclusivas colecciones para cada ocasi√≥n y personalidad.</p>
          <a href="#featured" class="btn btn-primary btn-lg">Encuentrala Ahora!</a>
        </div>
      </div>
      <div class="carousel-item" style="background-image: url('https://img.freepik.com/fotos-premium/diferentes-botellas-perfume-madera_127657-19935.jpg')">
        <div class="carousel-caption">
          <h1 class="display-4 fw-bold">Nuevas Fragancias, Nuevas Sensaciones</h1>
          <p class="lead">Lo √öltimo en Fragancias Exclusivas</p>
          <a href="#new" class="btn btn-primary btn-lg">Ver novedades</a>
        </div>
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#perfumeCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
      <span class="visually-hidden">Anterior</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#perfumeCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
      <span class="visually-hidden">Siguiente</span>
    </button>
  </div>

  <!-- Featured Products -->
  <section id="featured" class="py-5">
    <div class="container">
      <h2 class="section-title text-center mb-5">Productos Destacados</h2>
      <div class="row g-4" id="featuredProducts">
        <!-- Products will be loaded dynamically -->
      </div>
    </div>
  </section>

  <!-- Categories -->
  <section class="py-5 bg-light">
    <div class="container">
      <h2 class="section-title text-center mb-5">Nuestras Categor√≠as</h2>
      <div class="row g-4">
        <div class="col-md-4">
          <div class="category-card" id="men">
            <div class="category-image" style="background-image: url('https://liblibai-online.liblib.cloud/img/6fe77fcad9614c799944a901d1cc568a/8f93bb43-e992-4047-adaf-b0f529545c31.png?x-oss-process=image/resize,w_640,m_lfit/format,webp')">
              <div class="category-overlay">
                <h3>Hombres</h3>
                <a href="#" class="btn btn-outline-light">Ver colecci√≥n</a>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="category-card" id="women">
            <div class="category-image" style="background-image: url('https://liblibai-online.liblib.cloud/sd-gen-save-img/299151556-ff000c861d12edf337d54500a680afcb565835b351cba338e2ee91a38e4ae99a.png?x-oss-process=image/resize,w_764,m_lfit/format,webp')">
              <div class="category-overlay">
                <h3>Mujeres</h3>
                <a href="#" class="btn btn-outline-light">Ver colecci√≥n</a>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="category-card">
            <div class="category-image" style="background-image: url('https://liblibai-online.liblib.cloud/img/4b169d20e5af45b09a4303580b8b718c/3133a88e154e2ff93559ecd38955b2a94d729c4ea01aafebbcc18935b097155a.png?x-oss-process=image/resize,w_640,m_lfit/format,webp')">
              <div class="category-overlay">
                <h3>Unisex</h3>
                <a href="#" class="btn btn-outline-light">Ver colecci√≥n</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- New Arrivals -->
  <section id="new" class="py-5">
    <div class="container">
      <h2 class="section-title text-center mb-5">Novedades</h2>
      <div class="row g-4" id="newArrivals">
        <!-- New arrivals will load here -->
      </div>
    </div>
  </section>

  <!-- Newsletter -->
  <section class="newsletter text-white py-5">
    <div class="container">
      <h3 class="text-center mb-4">Suscr√≠bete a nuestro Newsletter</h3>
      <form class="newsletter-form d-flex justify-content-center" novalidate>
        <input type="email" class="form-control w-50 me-2" placeholder="Tu correo electr√≥nico" required />
        <button type="submit" class="btn btn-primary">Suscribirse</button>
      </form>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="py-5">
    <div class="container">
      <h2 class="section-title text-center mb-5">Contacto</h2>
      <form class="contact-form w-50 mx-auto" novalidate>
        <div class="mb-3">
          <label for="contactName" class="form-label">Nombre</label>
          <input type="text" class="form-control" id="contactName" required />
        </div>
        <div class="mb-3">
          <label for="contactEmail" class="form-label">Correo Electr√≥nico</label>
          <input type="email" class="form-control" id="contactEmail" required />
        </div>
        <div class="mb-3">
          <label for="contactMessage" class="form-label">Mensaje</label>
          <textarea class="form-control" id="contactMessage" rows="5" required></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Enviar</button>
      </form>
    </div>
  </section>

  <!-- Modal vista r√°pida producto -->
  <div class="modal fade" id="quickViewModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title product-name">Producto</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body d-flex flex-column flex-md-row">
          <img src="" alt="Imagen producto" class="product-image img-fluid me-md-3 mb-3 mb-md-0" style="max-width: 300px; object-fit: contain;" />
          <div>
            <h6 class="product-brand text-muted"></h6>
            <h4 class="product-price text-primary"></h4>
            <p><strong>Tama√±o: </strong><span class="size-value"></span></p>
            <p class="product-description"></p>
            <button class="btn btn-primary add-to-cart-btn" data-id="">Agregar al carrito</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal producto agregado -->
  <div class="modal fade" id="addedToCartModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Producto agregado</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body text-center">
          <i class="fas fa-check-circle text-success mb-3" style="font-size: 3rem;"></i>
          <p><span id="addedProductName"></span> ha sido agregado a tu carrito.</p>
        </div>
        <div class="modal-footer justify-content-center">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Seguir comprando</button>
          <button type="button" class="btn btn-primary" onclick="window.location.href='cart.html'">Ver carrito</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS Bundle & Custom Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // Sistema de autenticaci√≥n
    const auth = {
      currentUser: JSON.parse(localStorage.getItem('currentUser')) || null,

      login(username, password) {
        if (username && password) {
          this.currentUser = { username };
          localStorage.setItem('currentUser', JSON.stringify(this.currentUser));
          this.updateUI();
          return true;
        }
        return false;
      },

      logout() {
        this.currentUser = null;
        localStorage.removeItem('currentUser');
        this.updateUI();
        window.location.href = 'index.html';
      },

      isAdmin() {
        return this.currentUser && this.currentUser.username === 'admin';
      },

      updateUI() {
        const userSection = document.getElementById('userSection');
        const usernameDisplay = document.getElementById('usernameDisplay');
        const logoutBtn = document.querySelector('.logout-btn');
        const loginBtn = document.querySelector('.login-btn');
        const adminLink = document.querySelector('.admin-link');

        if (this.currentUser) {
          userSection.classList.add('logged-in');
          usernameDisplay.textContent = this.currentUser.username;
          logoutBtn.style.display = 'inline-block';
          loginBtn.style.display = 'none';

          if (this.isAdmin()) {
            adminLink.style.display = 'inline-block';
          } else {
            adminLink.style.display = 'none';
          }
        } else {
          userSection.classList.remove('logged-in');
          logoutBtn.style.display = 'none';
          loginBtn.style.display = 'inline-block';
          adminLink.style.display = 'none';
          usernameDisplay.textContent = '';
        }
      }
    };

    // Sistema de carrito
    const cart = {
      items: JSON.parse(localStorage.getItem('cartItems')) || [],

      save() {
        localStorage.setItem('cartItems', JSON.stringify(this.items));
        this.updateUI();
      },

      add(product) {
        const existing = this.items.find(item => item.id === product.id);
        if (existing) {
          existing.quantity++;
        } else {
          this.items.push({ ...product, quantity: 1 });
        }
        this.save();
        this.showAddedToCartModal(product);
      },

      remove(productId) {
        this.items = this.items.filter(item => item.id !== productId);
        this.save();
      },

      updateQuantity(productId, quantity) {
        const item = this.items.find(item => item.id === productId);
        if (item) {
          item.quantity = quantity;
          this.save();
        }
      },

      clear() {
        this.items = [];
        this.save();
      },

      total() {
        return this.items.reduce((sum, item) => sum + item.price * item.quantity, 0).toFixed(2);
      },

      count() {
        return this.items.reduce((sum, item) => sum + item.quantity, 0);
      },

      updateUI() {
        const cartCount = document.getElementById('contadorCarrito'); // Cambiado para coincidir con id en HTML
        const cartTotal = document.querySelector('.cart-total');
        const cartItemsContainer = document.getElementById('cartItems');

        cartCount.textContent = this.count();
        cartTotal.textContent = `$${parseFloat(this.total()).toLocaleString('es-CL')}`;

        if (cartItemsContainer) {
          cartItemsContainer.innerHTML = '';

          if (this.items.length === 0) {
            cartItemsContainer.innerHTML = '<p class="text-center empty-cart-message">Tu carrito est√° vac√≠o</p>';
            return;
          }

          this.items.forEach(item => {
            const el = document.createElement('div');
            el.classList.add('d-flex', 'justify-content-between', 'align-items-center', 'mb-2');
            el.innerHTML = `
              <div>
                <strong>${item.name}</strong><br>
                $${item.price.toLocaleString('es-CL')} x ${item.quantity}
              </div>
              <button class="btn btn-sm btn-danger" onclick="cart.remove('${item.id}')"><i class="fas fa-trash"></i></button>
            `;
            cartItemsContainer.appendChild(el);
          });
        }
      },

      showAddedToCartModal(product) {
        const modal = new bootstrap.Modal(document.getElementById('addedToCartModal'));
        document.getElementById('addedProductName').textContent = product.name;
        modal.show();
      },

      checkout() {
        if (this.items.length === 0) {
          alert('Tu carrito est√° vac√≠o');
          return;
        }

        if (!auth.currentUser) {
          alert('Por favor inicia sesi√≥n para continuar con la compra');
          window.location.href = 'login.html?redirect=cart.html';
          return;
        }

        alert(`Compra realizada por $${parseFloat(this.total()).toLocaleString('es-CL')}. ¬°Gracias por tu compra!`);
        this.clear();
        window.location.href = 'index.html';
      }
    };

    // Productos
    const products = {
      featured: [
        {
          id: 'p1',
          name: 'Sauvage Di Dior',
          brand: 'Perfulandia',
          price: 59990,
          image: 'https://imagedelivery.net/4fYuQyy-r8_rpBpcY7lH_A/falabellaCL/7285097_01/w=1500,h=1500,fit=pad',
          description: 'Sauvage de Dior es una fragancia masculina ic√≥nica, intensa y moderna, inspirada en la naturaleza salvaje y en paisajes abiertos bajo un cielo azul',
          size: '100ml'
        },
        {
          id: 'p2',
          name: 'Nukx Laflare',
          brand: 'Perfulandia',
          price: 69990,
          image: 'https://liblibai-online.liblib.cloud/img/58457b3ab09b46679ab5198980e50c21/603a58f0-2343-4e87-a67a-b18c6bcc32c9.png?x-oss-process=image/resize,w_640,m_lfit/format,webp',
          description: 'Fragancia masculina con notas amaderadas y especiadas, ideal para el hombre moderno.',
          size: '100ml'
        },
        {
          id: 'p3',
          name: 'Versace Eros',
          brand: 'Perfulandia',
          price: 54990,
          image: 'https://media.kohlsimg.com/is/image/kohls/1875e35b7764c0512dafc6ffaf52c02f570d9937?wid=400&hei=400&op_sharpen=1',
          description: 'Versace Eros es una fragancia masculina vibrante, audaz y profundamente seductora. Inspirado en la mitolog√≠a griega y en el dios del amor, Eros.',
          size: '50ml'
        }
      ],
      newArrivals: [
        {
          id: 'p4',
          name: 'Miss Dior',
          brand: 'Perfulandia',
          price: 79990,
          image: 'https://home.ripley.cl/store/Attachment/WOP/D327/2000385995708/2000385995708_2.jpg',
          description: 'Miss Dior es una fragancia femenina sofisticada y rom√°ntica, que celebra el amor, la belleza y la alegr√≠a de vivir.',
          size: '100ml'
        },
        {
          id: 'p5',
          name: 'Boss The Scent for Her de Hugo Boss',
          brand: 'Perfulandia',
          price: 49990,
          image: 'https://www.lodoro.cl/cdn/shop/products/1HUBOSSCENTEDP100M_1_1024x.png?v=1612969831',
          description: 'es una fragancia femenina de la familia olfativa floral frutal, lanzada en 2016. Destaca por su combinaci√≥n de notas dulces y c√°lidas, que la convierten en una opci√≥n sofisticada y sensual para diversas ocasiones',
          size: '50ml'
        },
        {
          id: 'p6',
          name: 'Chance',
          brand: 'Perfulandia',
          price: 64990,
          image: 'https://media.vogue.mx/photos/63595b75b16afcc77a2634ec/master/w_1600%2Cc_limit/Perfumes-Mujeres-Chanel-Chance.jpeg',
          description: 'Fragancia dulce y acogedora con notas de vainilla y almizcle, perfecta para las noches.',
          size: '100ml'
        }
      ]
    };

    // Renderizar productos
    function renderProducts() {
      const featuredContainer = document.getElementById('featuredProducts');
      const newArrivalsContainer = document.getElementById('newArrivals');

      if (featuredContainer) {
        featuredContainer.innerHTML = products.featured.map(product => `
          <div class="col-md-4">
            <div class="card h-100">
              <img src="${product.image}" class="card-img-top" alt="${product.name}">
              <div class="card-body d-flex flex-column">
                <h5 class="card-title">${product.name}</h5>
                <p class="card-text text-muted">${product.brand}</p>
                <p class="card-text">$${product.price.toLocaleString('es-CL')}</p>
                <p class="card-text small">${product.description.substring(0, 60)}...</p>
                <div class="mt-auto">
                  <button class="btn btn-outline-secondary btn-sm w-100 mb-2" onclick="showQuickView('${product.id}')">
                    <i class="fas fa-eye me-1"></i> Ver detalles
                  </button>
                  <button class="btn btn-primary btn-sm w-100" onclick='agregarAlCarrito(${JSON.stringify(product)})'>
                    <i class="fas fa-shopping-cart me-1"></i> Agregar
                  </button>
                </div>
              </div>
            </div>
          </div>
        `).join('');
      }

      if (newArrivalsContainer) {
        newArrivalsContainer.innerHTML = products.newArrivals.map(product => `
          <div class="col-md-4">
            <div class="card h-100">
              <img src="${product.image}" class="card-img-top" alt="${product.name}">
              <div class="card-body d-flex flex-column">
                <h5 class="card-title">${product.name}</h5>
                <p class="card-text text-muted">${product.brand}</p>
                <p class="card-text">$${product.price.toLocaleString('es-CL')}</p>
                <p class="card-text small">${product.description.substring(0, 60)}...</p>
                <div class="mt-auto">
                  <button class="btn btn-outline-secondary btn-sm w-100 mb-2" onclick="showQuickView('${product.id}')">
                    <i class="fas fa-eye me-1"></i> Ver detalles
                  </button>
                  <button class="btn btn-primary btn-sm w-100" onclick='agregarAlCarritoPorId("${product.id}")'>
                    <i class="fas fa-shopping-cart me-1"></i> Agregar
                  </button>
                </div>
              </div>
            </div>
          </div>
        `).join('');
      }
    }

    // Mostrar vista r√°pida del producto
    function showQuickView(productId) {
      const allProducts = [...products.featured, ...products.newArrivals];
      const product = allProducts.find(p => p.id === productId);

      if (product) {
        document.querySelector('.product-name').textContent = product.name;
        document.querySelector('.product-brand').textContent = product.brand;
        document.querySelector('.product-price').textContent = `$${product.price.toLocaleString('es-CL')}`;
        document.querySelector('.product-image').src = product.image;
        document.querySelector('.size-value').textContent = product.size;
        document.querySelector('.product-description').textContent = product.description;
        document.querySelector('.add-to-cart-btn').setAttribute('data-id', product.id);

        const quickViewModal = new bootstrap.Modal(document.getElementById('quickViewModal'));
        quickViewModal.show();
      }
    }

    // Funci√≥n para agregar al carrito usando ID (para nuevos productos)
    function agregarAlCarritoPorId(productId) {
      const allProducts = [...products.featured, ...products.newArrivals];
      const product = allProducts.find(p => p.id === productId);
      if (product) {
        agregarAlCarrito(product);
      } else {
        alert('Producto no encontrado');
      }
    }
    window.agregarAlCarritoPorId = agregarAlCarritoPorId;

    // Agregar al carrito con POST al backend y actualizar UI local
    function agregarAlCarrito(producto) {
      const perfumeFormateado = {
        nombrePerfume: producto.name,
        marca: producto.brand,
        precio: producto.price,
        cantidadMl: parseInt(producto.size) || 50,
        descripcion: producto.description,
        stock: 1,
        imagen: producto.image
      };

      fetch('http://localhost:8080/api/v1/carrito', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(perfumeFormateado)
      })
      .then(response => {
        if (response.ok) {
          alert("‚úÖ Perfume agregado al carrito (backend)");
          cart.add(producto); // actualizar carrito local y UI
        } else {
          alert("‚ùå Error al agregar perfume al carrito");
        }
      })
      .catch(error => {
        console.error("‚ùå Error de conexi√≥n con el backend:", error);
        alert("‚ùå No se pudo conectar al servidor");
      });
    }
    window.agregarAlCarrito = agregarAlCarrito;

    // Inicializaci√≥n al cargar la p√°gina
    document.addEventListener('DOMContentLoaded', function () {
      auth.updateUI();
      cart.updateUI();
      renderProducts();

      // Bot√≥n de agregar al carrito en modal vista r√°pida
      document.querySelector('.add-to-cart-btn').addEventListener('click', function () {
        const productId = this.getAttribute('data-id');
        const allProducts = [...products.featured, ...products.newArrivals];
        const product = allProducts.find(p => p.id === productId);

        if (product) {
          agregarAlCarrito(product);
          bootstrap.Modal.getInstance(document.getElementById('quickViewModal')).hide();
        }
      });

      // Formularios
      document.querySelector('.newsletter-form')?.addEventListener('submit', function (e) {
        e.preventDefault();
        alert('¬°Gracias por suscribirte a nuestro newsletter!');
        this.reset();
      });

      document.querySelector('.contact-form')?.addEventListener('submit', function (e) {
        e.preventDefault();
        alert('¬°Gracias por tu mensaje! Nos pondremos en contacto contigo pronto.');
        this.reset();
      });

      // Login autom√°tico desde par√°metros URL (simulado)
      const params = new URLSearchParams(window.location.search);
      const username = params.get('username');
      const loggedIn = params.get('loggedIn');

      if (loggedIn === 'true' && username) {
        auth.login(username, 'password'); // Contrase√±a simulada
      }
    });
  </script>
</body>
</html>
